import{r as u,n as le}from"./components-Ep370hT9.js";import{k as ut,o as Qe,m as dt,b as it,T as ht,a as pt,j as mt,t as ft}from"./heading-DJdNTOqn.js";import{S as gt}from"./meta-SKfl2jaX.js";import{b as bt}from"./image-Ctv1T852.js";import{u as yt}from"./useWindowSize-DjtojTbb.js";import{A as Et,G as wt,E as _t,r as te,Q as et,P as He,O as Ue,H as tt,V as ce,J as Se,K as Pe,X as Tt,Y as Re,Z as Ye,_ as Fe,e as Oe,$ as St,a0 as Pt,a1 as Rt,a2 as Mt,s as xt,S as nt,a3 as At,f as vt,u as Lt,a4 as Dt,a5 as Ot,a6 as jt,a7 as Ct,a8 as kt,a9 as It,aa as Nt,ab as Ft}from"./three.module-BUNYpaGn.js";import{r as zt,c as Ht,a as Yt,g as Ve,t as Bt,m as Gt,b as Ut}from"./throttle-CWUW5Plf.js";import{W as Te}from"./use-spring-BE8CLnYq.js";import"./config-AjS9vFOl.js";const Vt="/assets/earth-DvZudj9K.glb",Zt="/assets/milkyway-nx-Ds_hwpSC.hdr",Xt="/assets/milkyway-ny-BqhFvupA.hdr",Wt="/assets/milkyway-nz-D6l6T-pv.hdr",Kt="/assets/milkyway-px-BjIdbMt0.hdr",qt="/assets/milkyway-py-BD6pEbZF.hdr",$t="/assets/milkyway-pz-Bx3WFS88.hdr",Jt="/assets/milkyway-Vkpv7LbT.jpg";var Qt=Object.defineProperty,en=(i,o,m)=>o in i?Qt(i,o,{enumerable:!0,configurable:!0,writable:!0,value:m}):i[o]=m,s=(i,o,m)=>(en(i,typeof o!="symbol"?o+"":o,m),m);const ze=new Et,at=new wt,tn=Math.cos(70*(Math.PI/180)),ot=(i,o)=>(i%o+o)%o;class nn extends _t{constructor(o,m){super(),s(this,"object"),s(this,"domElement"),s(this,"enabled",!0),s(this,"target",new te),s(this,"minDistance",0),s(this,"maxDistance",1/0),s(this,"minZoom",0),s(this,"maxZoom",1/0),s(this,"minPolarAngle",0),s(this,"maxPolarAngle",Math.PI),s(this,"minAzimuthAngle",-1/0),s(this,"maxAzimuthAngle",1/0),s(this,"enableDamping",!1),s(this,"dampingFactor",.05),s(this,"enableZoom",!0),s(this,"zoomSpeed",1),s(this,"enableRotate",!0),s(this,"rotateSpeed",1),s(this,"enablePan",!0),s(this,"panSpeed",1),s(this,"screenSpacePanning",!0),s(this,"keyPanSpeed",7),s(this,"zoomToCursor",!1),s(this,"autoRotate",!1),s(this,"autoRotateSpeed",2),s(this,"reverseOrbit",!1),s(this,"reverseHorizontalOrbit",!1),s(this,"reverseVerticalOrbit",!1),s(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),s(this,"mouseButtons",{LEFT:Se.ROTATE,MIDDLE:Se.DOLLY,RIGHT:Se.PAN}),s(this,"touches",{ONE:Pe.ROTATE,TWO:Pe.DOLLY_PAN}),s(this,"target0"),s(this,"position0"),s(this,"zoom0"),s(this,"_domElementKeyEvents",null),s(this,"getPolarAngle"),s(this,"getAzimuthalAngle"),s(this,"setPolarAngle"),s(this,"setAzimuthalAngle"),s(this,"getDistance"),s(this,"getZoomScale"),s(this,"listenToKeyEvents"),s(this,"stopListenToKeyEvents"),s(this,"saveState"),s(this,"reset"),s(this,"update"),s(this,"connect"),s(this,"dispose"),s(this,"dollyIn"),s(this,"dollyOut"),s(this,"getScale"),s(this,"setScale"),this.object=o,this.domElement=m,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>w.phi,this.getAzimuthalAngle=()=>w.theta,this.setPolarAngle=t=>{let n=ot(t,2*Math.PI),c=w.phi;c<0&&(c+=2*Math.PI),n<0&&(n+=2*Math.PI);let M=Math.abs(n-c);2*Math.PI-M<M&&(n<c?n+=2*Math.PI:c+=2*Math.PI),j.phi=n-c,e.update()},this.setAzimuthalAngle=t=>{let n=ot(t,2*Math.PI),c=w.theta;c<0&&(c+=2*Math.PI),n<0&&(n+=2*Math.PI);let M=Math.abs(n-c);2*Math.PI-M<M&&(n<c?n+=2*Math.PI:c+=2*Math.PI),j.theta=n-c,e.update()},this.getDistance=()=>e.object.position.distanceTo(e.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",$),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",$),this._domElementKeyEvents=null},this.saveState=()=>{e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=()=>{e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(J),e.update(),E=p.NONE},this.update=(()=>{const t=new te,n=new te(0,1,0),c=new et().setFromUnitVectors(o.up,n),M=c.clone().invert(),U=new te,he=new et,Ee=2*Math.PI;return function(){const Je=e.object.position;c.setFromUnitVectors(o.up,n),M.copy(c).invert(),t.copy(Je).sub(e.target),t.applyQuaternion(c),w.setFromVector3(t),e.autoRotate&&E===p.NONE&&d(L()),e.enableDamping?(w.theta+=j.theta*e.dampingFactor,w.phi+=j.phi*e.dampingFactor):(w.theta+=j.theta,w.phi+=j.phi);let pe=e.minAzimuthAngle,me=e.maxAzimuthAngle;isFinite(pe)&&isFinite(me)&&(pe<-Math.PI?pe+=Ee:pe>Math.PI&&(pe-=Ee),me<-Math.PI?me+=Ee:me>Math.PI&&(me-=Ee),pe<=me?w.theta=Math.max(pe,Math.min(me,w.theta)):w.theta=w.theta>(pe+me)/2?Math.max(pe,w.theta):Math.min(me,w.theta)),w.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,w.phi)),w.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(re,e.dampingFactor):e.target.add(re),e.zoomToCursor&&f||e.object.isOrthographicCamera?w.radius=C(w.radius):w.radius=C(w.radius*z),t.setFromSpherical(w),t.applyQuaternion(M),Je.copy(e.target).add(t),e.object.matrixAutoUpdate||e.object.updateMatrix(),e.object.lookAt(e.target),e.enableDamping===!0?(j.theta*=1-e.dampingFactor,j.phi*=1-e.dampingFactor,re.multiplyScalar(1-e.dampingFactor)):(j.set(0,0,0),re.set(0,0,0));let ve=!1;if(e.zoomToCursor&&f){let Le=null;if(e.object instanceof He&&e.object.isPerspectiveCamera){const De=t.length();Le=C(De*z);const Ne=De-Le;e.object.position.addScaledVector(ae,Ne),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const De=new te(a.x,a.y,0);De.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/z)),e.object.updateProjectionMatrix(),ve=!0;const Ne=new te(a.x,a.y,0);Ne.unproject(e.object),e.object.position.sub(Ne).add(De),e.object.updateMatrixWorld(),Le=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;Le!==null&&(e.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(Le).add(e.object.position):(ze.origin.copy(e.object.position),ze.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(ze.direction))<tn?o.lookAt(e.target):(at.setFromNormalAndCoplanarPoint(e.object.up,e.target),ze.intersectPlane(at,e.target))))}else e.object instanceof Ue&&e.object.isOrthographicCamera&&(ve=z!==1,ve&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/z)),e.object.updateProjectionMatrix()));return z=1,f=!1,ve||U.distanceToSquared(e.object.position)>V||8*(1-he.dot(e.object.quaternion))>V?(e.dispatchEvent(J),U.copy(e.object.position),he.copy(e.object.quaternion),ve=!1,!0):!1}})(),this.connect=t=>{e.domElement=t,e.domElement.style.touchAction="none",e.domElement.addEventListener("contextmenu",Ae),e.domElement.addEventListener("pointerdown",Z),e.domElement.addEventListener("pointercancel",h),e.domElement.addEventListener("wheel",ye)},this.dispose=()=>{var t,n,c,M,U,he;e.domElement&&(e.domElement.style.touchAction="auto"),(t=e.domElement)==null||t.removeEventListener("contextmenu",Ae),(n=e.domElement)==null||n.removeEventListener("pointerdown",Z),(c=e.domElement)==null||c.removeEventListener("pointercancel",h),(M=e.domElement)==null||M.removeEventListener("wheel",ye),(U=e.domElement)==null||U.ownerDocument.removeEventListener("pointermove",S),(he=e.domElement)==null||he.ownerDocument.removeEventListener("pointerup",h),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",$)};const e=this,J={type:"change"},P={type:"start"},l={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let E=p.NONE;const V=1e-6,w=new tt,j=new tt;let z=1;const re=new te,A=new ce,O=new ce,X=new ce,H=new ce,B=new ce,k=new ce,g=new ce,ne=new ce,se=new ce,ae=new te,a=new ce;let f=!1;const r=[],b={};function L(){return 2*Math.PI/60/60*e.autoRotateSpeed}function T(){return Math.pow(.95,e.zoomSpeed)}function d(t){e.reverseOrbit||e.reverseHorizontalOrbit?j.theta+=t:j.theta-=t}function y(t){e.reverseOrbit||e.reverseVerticalOrbit?j.phi+=t:j.phi-=t}const _=(()=>{const t=new te;return function(c,M){t.setFromMatrixColumn(M,0),t.multiplyScalar(-c),re.add(t)}})(),ie=(()=>{const t=new te;return function(c,M){e.screenSpacePanning===!0?t.setFromMatrixColumn(M,1):(t.setFromMatrixColumn(M,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(c),re.add(t)}})(),oe=(()=>{const t=new te;return function(c,M){const U=e.domElement;if(U&&e.object instanceof He&&e.object.isPerspectiveCamera){const he=e.object.position;t.copy(he).sub(e.target);let Ee=t.length();Ee*=Math.tan(e.object.fov/2*Math.PI/180),_(2*c*Ee/U.clientHeight,e.object.matrix),ie(2*M*Ee/U.clientHeight,e.object.matrix)}else U&&e.object instanceof Ue&&e.object.isOrthographicCamera?(_(c*(e.object.right-e.object.left)/e.object.zoom/U.clientWidth,e.object.matrix),ie(M*(e.object.top-e.object.bottom)/e.object.zoom/U.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}})();function W(t){e.object instanceof He&&e.object.isPerspectiveCamera||e.object instanceof Ue&&e.object.isOrthographicCamera?z=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function G(t){W(z/t)}function ue(t){W(z*t)}function I(t){if(!e.zoomToCursor||!e.domElement)return;f=!0;const n=e.domElement.getBoundingClientRect(),c=t.clientX-n.left,M=t.clientY-n.top,U=n.width,he=n.height;a.x=c/U*2-1,a.y=-(M/he)*2+1,ae.set(a.x,a.y,1).unproject(e.object).sub(e.object.position).normalize()}function C(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function Q(t){A.set(t.clientX,t.clientY)}function we(t){I(t),g.set(t.clientX,t.clientY)}function ge(t){H.set(t.clientX,t.clientY)}function _e(t){O.set(t.clientX,t.clientY),X.subVectors(O,A).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(d(2*Math.PI*X.x/n.clientHeight),y(2*Math.PI*X.y/n.clientHeight)),A.copy(O),e.update()}function be(t){ne.set(t.clientX,t.clientY),se.subVectors(ne,g),se.y>0?G(T()):se.y<0&&ue(T()),g.copy(ne),e.update()}function Me(t){B.set(t.clientX,t.clientY),k.subVectors(B,H).multiplyScalar(e.panSpeed),oe(k.x,k.y),H.copy(B),e.update()}function je(t){I(t),t.deltaY<0?ue(T()):t.deltaY>0&&G(T()),e.update()}function Be(t){let n=!1;switch(t.code){case e.keys.UP:oe(0,e.keyPanSpeed),n=!0;break;case e.keys.BOTTOM:oe(0,-e.keyPanSpeed),n=!0;break;case e.keys.LEFT:oe(e.keyPanSpeed,0),n=!0;break;case e.keys.RIGHT:oe(-e.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),e.update())}function Ce(){if(r.length==1)A.set(r[0].pageX,r[0].pageY);else{const t=.5*(r[0].pageX+r[1].pageX),n=.5*(r[0].pageY+r[1].pageY);A.set(t,n)}}function R(){if(r.length==1)H.set(r[0].pageX,r[0].pageY);else{const t=.5*(r[0].pageX+r[1].pageX),n=.5*(r[0].pageY+r[1].pageY);H.set(t,n)}}function x(){const t=r[0].pageX-r[1].pageX,n=r[0].pageY-r[1].pageY,c=Math.sqrt(t*t+n*n);g.set(0,c)}function D(){e.enableZoom&&x(),e.enablePan&&R()}function K(){e.enableZoom&&x(),e.enableRotate&&Ce()}function q(t){if(r.length==1)O.set(t.pageX,t.pageY);else{const c=Ge(t),M=.5*(t.pageX+c.x),U=.5*(t.pageY+c.y);O.set(M,U)}X.subVectors(O,A).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(d(2*Math.PI*X.x/n.clientHeight),y(2*Math.PI*X.y/n.clientHeight)),A.copy(O)}function F(t){if(r.length==1)B.set(t.pageX,t.pageY);else{const n=Ge(t),c=.5*(t.pageX+n.x),M=.5*(t.pageY+n.y);B.set(c,M)}k.subVectors(B,H).multiplyScalar(e.panSpeed),oe(k.x,k.y),H.copy(B)}function v(t){const n=Ge(t),c=t.pageX-n.x,M=t.pageY-n.y,U=Math.sqrt(c*c+M*M);ne.set(0,U),se.set(0,Math.pow(ne.y/g.y,e.zoomSpeed)),G(se.y),g.copy(ne)}function de(t){e.enableZoom&&v(t),e.enablePan&&F(t)}function Y(t){e.enableZoom&&v(t),e.enableRotate&&q(t)}function Z(t){var n,c;e.enabled!==!1&&(r.length===0&&((n=e.domElement)==null||n.ownerDocument.addEventListener("pointermove",S),(c=e.domElement)==null||c.ownerDocument.addEventListener("pointerup",h)),Ie(t),t.pointerType==="touch"?xe(t):N(t))}function S(t){e.enabled!==!1&&(t.pointerType==="touch"?ke(t):ee(t))}function h(t){var n,c,M;lt(t),r.length===0&&((n=e.domElement)==null||n.releasePointerCapture(t.pointerId),(c=e.domElement)==null||c.ownerDocument.removeEventListener("pointermove",S),(M=e.domElement)==null||M.ownerDocument.removeEventListener("pointerup",h)),e.dispatchEvent(l),E=p.NONE}function N(t){let n;switch(t.button){case 0:n=e.mouseButtons.LEFT;break;case 1:n=e.mouseButtons.MIDDLE;break;case 2:n=e.mouseButtons.RIGHT;break;default:n=-1}switch(n){case Se.DOLLY:if(e.enableZoom===!1)return;we(t),E=p.DOLLY;break;case Se.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;ge(t),E=p.PAN}else{if(e.enableRotate===!1)return;Q(t),E=p.ROTATE}break;case Se.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;Q(t),E=p.ROTATE}else{if(e.enablePan===!1)return;ge(t),E=p.PAN}break;default:E=p.NONE}E!==p.NONE&&e.dispatchEvent(P)}function ee(t){if(e.enabled!==!1)switch(E){case p.ROTATE:if(e.enableRotate===!1)return;_e(t);break;case p.DOLLY:if(e.enableZoom===!1)return;be(t);break;case p.PAN:if(e.enablePan===!1)return;Me(t);break}}function ye(t){e.enabled===!1||e.enableZoom===!1||E!==p.NONE&&E!==p.ROTATE||(t.preventDefault(),e.dispatchEvent(P),je(t),e.dispatchEvent(l))}function $(t){e.enabled===!1||e.enablePan===!1||Be(t)}function xe(t){switch($e(t),r.length){case 1:switch(e.touches.ONE){case Pe.ROTATE:if(e.enableRotate===!1)return;Ce(),E=p.TOUCH_ROTATE;break;case Pe.PAN:if(e.enablePan===!1)return;R(),E=p.TOUCH_PAN;break;default:E=p.NONE}break;case 2:switch(e.touches.TWO){case Pe.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;D(),E=p.TOUCH_DOLLY_PAN;break;case Pe.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;K(),E=p.TOUCH_DOLLY_ROTATE;break;default:E=p.NONE}break;default:E=p.NONE}E!==p.NONE&&e.dispatchEvent(P)}function ke(t){switch($e(t),E){case p.TOUCH_ROTATE:if(e.enableRotate===!1)return;q(t),e.update();break;case p.TOUCH_PAN:if(e.enablePan===!1)return;F(t),e.update();break;case p.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;de(t),e.update();break;case p.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Y(t),e.update();break;default:E=p.NONE}}function Ae(t){e.enabled!==!1&&t.preventDefault()}function Ie(t){r.push(t)}function lt(t){delete b[t.pointerId];for(let n=0;n<r.length;n++)if(r[n].pointerId==t.pointerId){r.splice(n,1);return}}function $e(t){let n=b[t.pointerId];n===void 0&&(n=new ce,b[t.pointerId]=n),n.set(t.pageX,t.pageY)}function Ge(t){const n=t.pointerId===r[0].pointerId?r[1]:r[0];return b[n.pointerId]}this.dollyIn=(t=T())=>{ue(t),e.update()},this.dollyOut=(t=T())=>{G(t),e.update()},this.getScale=()=>z,this.setScale=t=>{W(t),e.update()},this.getZoomScale=()=>T(),m!==void 0&&this.connect(m),this.update()}}class an extends Tt{constructor(o){super(o),this.type=Re}parse(o){const l=function(a,f){switch(a){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(f||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(f||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(f||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(f||""))}},w=`
`,j=function(a,f,r){f=f||1024;let L=a.pos,T=-1,d=0,y="",_=String.fromCharCode.apply(null,new Uint16Array(a.subarray(L,L+128)));for(;0>(T=_.indexOf(w))&&d<f&&L<a.byteLength;)y+=_,d+=_.length,L+=128,_+=String.fromCharCode.apply(null,new Uint16Array(a.subarray(L,L+128)));return-1<T?(a.pos+=d+T+1,y+_.slice(0,T)):!1},z=function(a){const f=/^#\?(\S+)/,r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,b=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*FORMAT=(\S+)\s*$/,T=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,d={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let y,_;for((a.pos>=a.byteLength||!(y=j(a)))&&l(1,"no header found"),(_=y.match(f))||l(3,"bad initial token"),d.valid|=1,d.programtype=_[1],d.string+=y+`
`;y=j(a),y!==!1;){if(d.string+=y+`
`,y.charAt(0)==="#"){d.comments+=y+`
`;continue}if((_=y.match(r))&&(d.gamma=parseFloat(_[1])),(_=y.match(b))&&(d.exposure=parseFloat(_[1])),(_=y.match(L))&&(d.valid|=2,d.format=_[1]),(_=y.match(T))&&(d.valid|=4,d.height=parseInt(_[1],10),d.width=parseInt(_[2],10)),d.valid&2&&d.valid&4)break}return d.valid&2||l(3,"missing format specifier"),d.valid&4||l(3,"missing image size specifier"),d},re=function(a,f,r){const b=f;if(b<8||b>32767||a[0]!==2||a[1]!==2||a[2]&128)return new Uint8Array(a);b!==(a[2]<<8|a[3])&&l(3,"wrong scanline width");const L=new Uint8Array(4*f*r);L.length||l(4,"unable to allocate buffer space");let T=0,d=0;const y=4*b,_=new Uint8Array(4),ie=new Uint8Array(y);let oe=r;for(;oe>0&&d<a.byteLength;){d+4>a.byteLength&&l(1),_[0]=a[d++],_[1]=a[d++],_[2]=a[d++],_[3]=a[d++],(_[0]!=2||_[1]!=2||(_[2]<<8|_[3])!=b)&&l(3,"bad rgbe scanline format");let W=0,G;for(;W<y&&d<a.byteLength;){G=a[d++];const I=G>128;if(I&&(G-=128),(G===0||W+G>y)&&l(3,"bad scanline data"),I){const C=a[d++];for(let Q=0;Q<G;Q++)ie[W++]=C}else ie.set(a.subarray(d,d+G),W),W+=G,d+=G}const ue=b;for(let I=0;I<ue;I++){let C=0;L[T]=ie[I+C],C+=b,L[T+1]=ie[I+C],C+=b,L[T+2]=ie[I+C],C+=b,L[T+3]=ie[I+C],T+=4}oe--}return L},A=function(a,f,r,b){const L=a[f+3],T=Math.pow(2,L-128)/255;r[b+0]=a[f+0]*T,r[b+1]=a[f+1]*T,r[b+2]=a[f+2]*T,r[b+3]=1},O=function(a,f,r,b){const L=a[f+3],T=Math.pow(2,L-128)/255;r[b+0]=Fe.toHalfFloat(Math.min(a[f+0]*T,65504)),r[b+1]=Fe.toHalfFloat(Math.min(a[f+1]*T,65504)),r[b+2]=Fe.toHalfFloat(Math.min(a[f+2]*T,65504)),r[b+3]=Fe.toHalfFloat(1)},X=new Uint8Array(o);X.pos=0;const H=z(X),B=H.width,k=H.height,g=re(X.subarray(X.pos),B,k);let ne,se,ae;switch(this.type){case Ye:ae=g.length/4;const a=new Float32Array(ae*4);for(let r=0;r<ae;r++)A(g,r*4,a,r*4);ne=a,se=Ye;break;case Re:ae=g.length/4;const f=new Uint16Array(ae*4);for(let r=0;r<ae;r++)O(g,r*4,f,r*4);ne=f,se=Re;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:B,height:k,data:ne,header:H.string,gamma:H.gamma,exposure:H.exposure,type:se}}setDataType(o){return this.type=o,this}load(o,m,e,J){function P(l,p){switch(l.type){case Ye:case Re:"colorSpace"in l?l.colorSpace="srgb-linear":l.encoding=3e3,l.minFilter=Oe,l.magFilter=Oe,l.generateMipmaps=!1,l.flipY=!0;break}m&&m(l,p)}return super.load(o,P,e,J)}}class on extends St{constructor(o){super(o),this.hdrLoader=new an,this.type=Re}load(o,m,e,J){typeof o=="string"?o=[o]:Array.isArray(o)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(o),o=m,m=e,e=J,J=arguments[4]);const P=new Pt;switch(P.type=this.type,P.type){case Ye:case Re:"colorSpace"in P?P.colorSpace="srgb-linear":P.encoding=3e3,P.minFilter=Oe,P.magFilter=Oe,P.generateMipmaps=!1;break}const l=this;let p=0;function E(V,w,j,z){new Rt(l.manager).setPath(l.path).setResponseType("arraybuffer").setWithCredentials(l.withCredentials).load(o[V],function(re){p++;const A=l.hdrLoader.parse(re);if(A){if(A.data!==void 0){const O=new Mt(A.data,A.width,A.height);O.type=P.type,"colorSpace"in O?O.colorSpace=P.SRGBColorSpace:O.encoding=P.encoding,O.format=P.format,O.minFilter=P.minFilter,O.magFilter=P.magFilter,O.generateMipmaps=P.generateMipmaps,P.images[V]=O}p===6&&(P.needsUpdate=!0,w&&w(P))}},j,z)}for(let V=0;V<o.length;V++)E(V,m,e,J);return P}setDataType(o){return this.type=o,this.hdrLoader.setDataType(o),this}}const rt=(i,o,m)=>{if(m){if(Math.min(i,o)===i)return o;if(Math.max(i,m)===i)return m}else return Math.max(i,o)===o?i:o;return i},rn="_earth_1awhs_1",sn="_loader_1awhs_8",cn="_viewport_1awhs_22",ln="_canvas_1awhs_33",un="_labels_1awhs_52",dn="_label_1awhs_52",hn="_vignette_1awhs_82",pn="_sections_1awhs_94",mn="_section_1awhs_94",fn="_noise_1awhs_1",fe={earth:rn,loader:sn,viewport:cn,canvas:ln,labels:un,label:dn,vignette:hn,sections:pn,section:mn,noise:fn},qe={x:0,y:0,z:2},Ze=(i,o,m)=>i+m*(o-i),st=i=>Object.keys(i).map(o=>parseFloat(Math.round(i[o]*100)/100).toFixed(2)).join(", "),Xe=i=>!i||!i.camera?qe:{x:i.camera[0],y:i.camera[1],z:i.camera[2]},gn=(i,o)=>{const m=(e=0)=>Math.round((e+Number.EPSILON)*100)/100;return m(i==null?void 0:i.x)===m(o==null?void 0:o.x)&&m(i==null?void 0:i.y)===m(o==null?void 0:o.y)&&m(i==null?void 0:i.z)===m(o==null?void 0:o.z)},We={stiffness:80,damping:40,mass:2,restSpeed:.001,restDelta:.001},Ke={stiffness:40,damping:30,mass:2,restSpeed:.001,restDelta:.001},bn={stiffness:40,damping:30},ct=u.createContext({}),An=({position:i=[0,0,0],scale:o=1,hideMeshes:m=[],labels:e=[],className:J,children:P})=>{const[l,p]=u.useState(!1),[E,V]=u.useState(!1),[w,j]=u.useState(!1),[z,re]=u.useState(!1),A=u.useRef([]),O=u.useRef(),X=u.useRef(),H=u.useRef(),B=u.useRef(),k=u.useRef(),g=u.useRef(),ne=u.useRef(),se=u.useRef(),ae=u.useRef(),a=u.useRef(),f=u.useRef(),r=u.useRef(),b=bt(H),L=u.useRef(),T=u.useRef(Xe(A.current[0])),d=u.useRef([]),y=u.useRef(),_=u.useRef(),ie=u.useRef(),oe=u.useRef(),{width:W,height:G}=yt(),ue=ut(),I=Te(0,We),C=Te(0,We),Q=Te(0,We),we=Te(0,Ke),ge=Te(0,Ke),_e=Te(0,Ke),be=Te(0,bn),Me=u.useCallback(()=>{if(!b){cancelAnimationFrame(L.current);return}L.current=requestAnimationFrame(Me);const R=ne.current.getDelta();r.current.update(R),y.current.update(),k.current.render(B.current,g.current),d.current.forEach(x=>{const{element:D,position:K,sprite:q}=x,F=new te(...K),v=g.current.position.distanceTo(a.current.position),Y=g.current.position.distanceTo(q.position)>v;F.project(g.current),F.x=Math.round((.5+F.x/2)*window.innerWidth),F.y=Math.round((.5-F.y/2)*window.innerHeight),D.style.setProperty("--posX",Qe(F.x)),D.style.setProperty("--posY",Qe(F.y)),Y?D.dataset.occluded=!0:D.dataset.occluded=!1})},[b]);u.useEffect(()=>{oe.current=!0;const{innerWidth:R,innerHeight:x}=window;k.current=new xt({canvas:H.current,antialias:!1,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),k.current.setPixelRatio(1),k.current.outputColorSpace=nt,k.current.toneMapping=At,g.current=new He(54,R/x,.1,100),g.current.position.x=T.current.x,g.current.position.y=T.current.y,g.current.position.z=T.current.z,g.current.lookAt(0,0,0),I.set(g.current.position.x,!1),C.set(g.current.position.y,!1),Q.set(g.current.position.z,!1),B.current=new vt,ne.current=new Lt,ae.current=new Dt;const D=new Ot(2236962,.05),K=new jt(16777215,1.5);K.position.set(3,0,1);const q=[D,K];return q.forEach(F=>B.current.add(F)),y.current=new nn(g.current,H.current),y.current.enableZoom=!1,y.current.enablePan=!1,y.current.enableDamping=!1,y.current.rotateSpeed=.5,()=>{oe.current=!1,cancelAnimationFrame(L.current),zt(q),Ht(B.current),Yt(k.current)}},[]),u.useEffect(()=>{const R=()=>{V(!0),I.stop(),C.stop(),Q.stop()},x=()=>{I.set(g.current.position.x,!1),C.set(g.current.position.y,!1),Q.set(g.current.position.z,!1),V(!1)};return y.current.addEventListener("start",R),y.current.addEventListener("end",x),()=>{y.current.removeEventListener("start",R),y.current.removeEventListener("end",x)}},[I,C,Q]),u.useEffect(()=>{if(!l)return;const R=Ve("Chunk",a.current),x=Ve("Atmosphere",a.current),D=(h,N)=>{g.current.position[h]=N},K=I.on("change",h=>D("x",h)),q=C.on("change",h=>D("y",h)),F=Q.on("change",h=>D("z",h)),v=(h,N)=>{R.position[h]=N},de=we.on("change",h=>v("x",h)),Y=ge.on("change",h=>v("y",h)),Z=_e.on("change",h=>v("z",h)),S=be.on("change",h=>{x.material.opacity=h});return()=>{K(),q(),F(),de(),Y(),Z(),S()}},[I,C,Q,we,ge,_e,l,be]),u.useEffect(()=>{W<=dt.tablet&&(y.current.enabled=!1)},[W]),u.useEffect(()=>{if(l)return;const R=new on,x=new Ct(k.current);x.compileCubemapShader();const D=async()=>{const v=await Gt.loadAsync(Vt);a.current=v.scene,f.current=v.animations,r.current=new It(a.current),r.current.timeScale=.1,a.current.traverse(async de=>{const{material:Y,name:Z}=de;Z==="Atmosphere"&&(Y.alphaMap=Y.map),Y&&await k.current.initTexture(Y)}),a.current.position.x=i[0],a.current.position.y=i[1],a.current.position.z=i[2],a.current.scale.x=o,a.current.scale.y=o,a.current.scale.z=o},K=async()=>{const v=await R.loadAsync([Zt,Xt,Wt,Kt,qt,$t]);v.magFilter=Oe,_.current=x.fromCubemap(v),x.dispose(),await k.current.initTexture(_.current.texture)},q=async()=>{const v=await Ut.loadAsync(Jt);v.mapping=Nt,v.colorSpace=nt,B.current.background=v,await k.current.initTexture(v)},F=async()=>{await Promise.all([q(),K(),D()]),a.current.traverse(({material:v})=>{v&&(v.envMap=_.current.texture,v.needsUpdate=!0)}),oe.current&&p(!0)};u.startTransition(()=>{F(),setTimeout(()=>{re(!0)},1e3)})},[l,i,o]),u.useEffect(()=>(l&&!ie.current&&(B.current.add(a.current),ie.current=!0),l&&b&&(j(!0),Me()),()=>{cancelAnimationFrame(L.current)}),[Me,b,l]),u.useEffect(()=>{l&&(X.current.innerHTML="",d.current=e.map(R=>{const x=document.createElement("div");x.classList.add(fe.label),x.dataset.hidden=!0,x.style.setProperty("--delay",`${R.delay||0}ms`),x.textContent=R.text,X.current.appendChild(x);const D=new kt;return D.position.set(...R.position),D.scale.set(60,60,1),{element:x,...R,sprite:D}}))},[e,l]),u.useEffect(()=>{k.current.setSize(W,G),g.current.aspect=W/G,g.current.updateProjectionMatrix()},[W,G]),u.useEffect(()=>{const R=H.current,x=D=>{const{innerWidth:K,innerHeight:q}=window,F=st(g.current.position);console.info({cameraPosition:F}),se.current=new ce(D.clientX/K*2-1,-(D.clientY/q)*2+1),ae.current.setFromCamera(se.current,g.current);const v=ae.current.intersectObjects(B.current.children,!0);if(v.length>0){const de=st(v[0].point);console.info({clickPosition:de})}};return()=>{R.removeEventListener("click",x)}},[]);const je=u.useCallback(()=>{if(!O.current)return;const{offsetTop:R}=O.current,{innerHeight:x}=window,D=window.scrollY-R;let K;const q=Y=>{const Z=A.current[Y].meshes;a.current.traverse(S=>{const{name:h}=S,N=Ve("Chunk",a.current),ee=Z==null?void 0:Z.includes(h),ye=m==null?void 0:m.includes(h);if(ee)if(h==="Atmosphere")S.visible=!0,be.set(1);else if(h==="Chunk"){const $=new te(-.4,.4,.4);S.visible=!0,ue?S.position.set(...$.toArray()):(we.set($.x),ge.set($.y),_e.set($.z))}else h==="EarthFull"&&N.visible?S.visible=!1:S.visible=!0;else if(ye&&!ee)if(h==="Atmosphere")be.set(0);else if(h==="Chunk"){const $=new te(0,0,0);gn($,N.position)&&(S.visible=!1),we.set($.x),ge.set($.y),_e.set($.z)}else h==="EarthPartial"&&N.visible?S.visible=!0:S.visible=!1})},F=Y=>{const Z=A.current[Y].animations;ue||(f.current.forEach((S,h)=>{Z.find(N=>N.includes(h.toString()))||r.current.clipAction(S).reset().stop()}),f.current.length&&A.current[Y].animations&&Z.forEach(S=>{const h=S.split(":"),N=f.current[Number(h[0])],ee=r.current.clipAction(N);(!h[1]||h[1]!=="loop")&&(ee.clampWhenFinished=!0,ee.loop=Ft),ee.play()}))},v=Y=>{d.current.forEach(S=>{S.hidden&&(S.element.dataset.hidden=!0,S.element.setAttribute("aria-hidden",!0))}),A.current[Y].labels.forEach(S=>{d.current.filter(N=>N.text===S).forEach(N=>{N.element.dataset.hidden=!1,N.element.setAttribute("aria-hidden",!1)})})};requestAnimationFrame(()=>{const Y=A.current.length-1,Z=Math.floor(D/x),S=rt(Z,0,Y),h=A.current[S],N=A.current[S+1],ee=Xe(h)||qe,ye=Xe(N)||qe,$=(D-x*S)/x,xe=rt($,0,1),ke=Ze(ee.x,ye.x,xe),Ae=Ze(ee.y,ye.y,xe),Ie=Ze(ee.z,ye.z,xe);if(K!==ee&&A.current.length&&h&&(q(S),F(S),v(S)),K=ee,!E){if(ue){g.current.position.set(ke,Ae,Ie);return}I.set(ke),C.set(Ae),Q.set(Ie)}})},[I,C,Q,we,ge,_e,E,m,be,ue]);u.useEffect(()=>{const R=Bt(je,100);return l&&b&&window.addEventListener("scroll",R),()=>{window.removeEventListener("scroll",R)}},[je,b,l,be]);const Be=u.useCallback(R=>{A.current=[...A.current,R]},[]),Ce=u.useCallback(R=>{A.current=A.current.filter(x=>x!==R)},[]);return le.jsx(ct.Provider,{value:{registerSection:Be,unregisterSection:Ce},children:le.jsxs("div",{className:it(fe.earth,J),ref:O,children:[le.jsxs("div",{className:fe.viewport,children:[le.jsx("canvas",{className:fe.canvas,"data-visible":l&&w,"data-grabbing":E,ref:H}),le.jsx("div",{className:fe.labels,"aria-live":"polite",ref:X}),le.jsx("div",{className:fe.vignette})]}),le.jsx("div",{className:fe.sections,children:P}),le.jsx(ht,{unmount:!0,in:!l&&z,timeout:pt(ft.base.durationL),children:R=>le.jsx(gt,{className:fe.loader,"data-visible":R,children:le.jsx(mt,{})})})]})})},vn=u.memo(({children:i,scrim:o,scrimReverse:m,className:e,camera:J=[0,0,0],animations:P=[],meshes:l=[],labels:p=[]})=>{const{registerSection:E,unregisterSection:V}=u.useContext(ct),w=u.useRef(),j=JSON.stringify(P)+JSON.stringify(J)+JSON.stringify(p)+JSON.stringify(l);return u.useEffect(()=>{const z={camera:J,animations:P,meshes:l,labels:p,sectionRef:w};return E(z),()=>{V(z)}},[j,E,V]),le.jsx("div",{className:it(fe.section,e),"data-scrim":o,"data-scrim-reverse":m,ref:w,children:i})});export{An as Earth,vn as EarthSection};
